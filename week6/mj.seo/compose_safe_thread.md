# 안전한 스레드 구성

### Thread Safe

- 여러 스레드에서 **`클래스`**나 **`객체`**에 동시에 접근해서 작업하더라도 지속적인 **`정합성`**이 보장되는 코드를 **`Thread-Safe`** 하다고 한다.
- **`스레드`**에 안전한 코드에는 **`Race Condition`**이 없다.

### MultiThread Programming

- **`임계영역`**을 동기화 한다
    - 동시에 여러개의 **`스레드`**가 임계영역에 접근하지 못하게 **`Lock`**을 사용한다.
- **`동기화 도구`**를 사용한다
    - **세마포어**, CAS, **Atomic** 변수, 동시성 자료구조 등을 사용한다.
- **`스레드`**의 **스택**에 **한정**해서 상태를 관리한다.
    - **`스택 메모리`** 안에서 상태를 관리해서 다른 **`스레드`**와 상태를 공유하지 않도록 한다.
- **`Thread Local`**을 **사용**한다.
    - 스레드마다 가지고 있는 전용 저장소인 **`ThreadLocal`**을 사용한다.
- **`불변 객체`**를 사용한다.
    - 객체의 상태를 변경할 수 없도록 **`클래스`**를 만들어 **사용**한다.

### Thread Stack

- **`지역 변수`**
    - 기본형 지역 변수는 **`스택`**에 **`저장`**되므로 스레드간에 **공유**될 수 없다.
    - **`메서드`**로 전달되는 기본형 파라미터 변수도 **`스택`**에서만 **`관리`**된다.

- **`지역 객체 참조`**
    - **`지역 변수`**라 할지라도 객체 참조 변수는 메모리의 **heap 영역**에 **저장**된다.
    - 해당 **`메서드`** 안에서객체를 생성하고 외부로 공유하지 않으면 **`Thread-Safe`** 하다.

### Immutable Object

- **`Setter`** 메서드가 없다.
- **`생성자`**에서 멤버 변수를 초기화하고 **`final`**로 선언한다.
  ```java
  public class Immutable {
  	private final int value1;
  	private final int value2;
  	
  	public ImmutableValue(int value1, String value2) {
  		this.value1 = value1;
  		this.value2 = value2;
  	}
  }
  ```
