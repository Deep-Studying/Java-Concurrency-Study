# UserLevelThread & KernelLevelThread

### UserLevelThread

- 사용자 수준 쓰레드는 **사용자 영역에서 쓰레드 라이브러리에 의해 생성, 종료 메시지 전달 등 관리**
- 커널은 사용자 수준 쓰레드에 대해 알지 못하며 **단일 쓰레드 프로세스인 것 처럼 관리하게 된다.**

### KernelLevelThread

- CPU는 커널에 의해 생성된 **커널 쓰레드의 실행만을 담당한다.**
- 커널 수준 쓰레드란 **커널이 쓰레드와 관련된 모든 작업을 관리한다(PCB, TCB 관리 및 유지)**
- 커널은 커널 쓰레드의 모든 정보를 알고 있으며 **커널 쓰레드는 OS 스케쥴러에 의해 스케줄링 된다.**

### 멀티 쓰레딩 모델

- CPU는 OS Scheduler가 예약하는 커널 쓰레드만 할당받아
  실행시키기에 사용자 수준 쓰레드는 커널 수준 쓰레드와의 매핑이 필요하다.
- 사용자 수준 쓰레드는 세 가지 모델로 커널 수준 쓰레드와 매핑 및 구현이 가능하다.
    - 다대일 쓰레드 매핑, 일대일 쓰레드 매핑, 다대다 쓰레드 매핑

### 다대일 쓰레드 매핑  (many to one thread mapping)

다수의 사용자 수준 쓰레드가 커널 수준 쓰레드 한 개에 매핑하는 유형으로 사용자 수준의 쓰레드 모델

---

- 커널 개입 없이 사용자 쓰레드끼리의 스위칭이 발생하여 오버헤드가 적다.
- 자바에서는 초기 버전의 Green Thread가 이 모델에 해당한다고 볼 수 있다.
- 스케쥴링이나 동기화를 하려고 커널을 호출하지 않으므로 커널 영역 전환 오버헤드가 줄어든다.
- 개별 쓰레드가 아닌 단일 쓰레드의 프로세스 단위로 프로세서를 할당하기에 멀티코어 활용 병렬처리 불가

### 일대일 쓰레드 매핑(ont to one thread mapping)

사용자 수준 쓰레드와 커널 수준 쓰레드가 일대일로 매핑하는 유형으로 커널 수준의 쓰레드 모델

---

- 자바에서는 Native Thread가 이 모델에 해당한다고 볼 수 있다.
- 자원 한정으로 인해 쓰레드를 무한정 생성 불가, 대인으로 쓰레드 풀을 활용하기도 한다.
- 커널이 전체 프로세스와 쓰레드 정보를 유지해야 하기 때문에 컨텍스트 스위칭 시 오버헤드 발생

### 다대다 쓰레드 매핑 (many to many thread mapping)

여러개의 사용자 수준 쓰레드를 같은 수 또는 그 보다 작은 수의 커널 수준 쓰레드로 매핑

---

- 각 커널 수준의 쓰레드가 사용자 수준의 쓰레드 한 개 이상과 매핑된다.
- 다대다 모델은 다대일, 일대일 모델의 단점을 어느정도 해결하여 필요한 만큼 사용자 수준
  쓰레드를  성할 수 있고 커널 수준 쓰레드가 멀티 프로세서에서 병렬로 수행될 수 있다.
- 사용자 수준 쓰레드가 I/O 시스템 콜을 발생시켰을 때, 커널이 다른 쓰레드의 수행을 스케줄 할 수 있다.